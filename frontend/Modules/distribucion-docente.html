<!doctype html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Distribución Docente</title>

  <!-- Look & feel compartido -->
  <link rel="stylesheet" href="/styles/config.css">
  <link rel="stylesheet" href="../styles/distribucion-docente.css">
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
        referrerpolicy="no-referrer"/>

  <script>
    (function () {
      var theme = localStorage.getItem('theme') || 'light';
      var root = document.documentElement;
      if (theme === 'dark') root.classList.add('dark-mode');
      root.classList.add('no-theme-transitions');
    })();
  </script>
  
  <style>
    .description-legend {
      text-align: center;
      margin: 0.2rem 0 1rem 0;
      font-size: 0.9rem;
      color: #6c757d;
      line-height: 1.3;
    }

    .dark-mode .description-legend {
      color: #adb5bd;
    }
  </style>
</head>

<body>
  <!-- Overlay de carga -->
  <div id="loading-overlay" class="loading-overlay" style="display:none;">
    <div class="loading-spinner">
      <i class="fas fa-spinner fa-spin"></i> Procesando datos...
    </div>
  </div>

  <div class="container">
    <h2>Distribución Docente</h2>
    <div class="description-legend">
      Carga académica y clases (mapa calor)
    </div>
    
    <div class="config-section">
      <div class="toolbar">
        <div class="search-container" style="position: relative; margin-bottom: 20px;">
          <div class="input-group">
            <input type="text" 
                  id="docenteInput" 
                  placeholder="Buscar docente..."
                  class="form-control"
                  autocomplete="off">
            <button type="button" id="clearBtn" class="btn btn-outline-secondary">
              Limpiar
            </button>
          </div>
          <div id="docenteDropdown" class="autocomplete-dropdown"></div>
        </div>
        <button id="goMenu" class="secondary-button action-button">
         Ir a Menú
        </button>
      </div>

      <div class="legend" id="heatLegend">
        <span class="note" style="margin-right:8px;">Mapa de Calor (Clases):</span>
        <span class="box" style="background: hsl(120 60% 45%);"></span>
        <span class="note">Baja ocupación</span>
        <span class="box" style="background: hsl(60 60% 45%);"></span>
        <span class="note">Media</span>
        <span class="box" style="background: hsl(0 60% 45%);"></span>
        <span class="note">Alta</span>
      </div>

      <div class="grid-wrap" id="heatWrap">
        <table class="grid" id="heatTable">
          <thead>
            <tr>
              <th style="width:80px;">Hora</th>
              <th>LUNES</th><th>MARTES</th><th>MIERCOLES</th><th>JUEVES</th><th>VIERNES</th><th>SABADO</th>
            </tr>
          </thead>
          <tbody id="heatBody"></tbody>
        </table>
      </div>

      <!-- Cabecera del docente (nombre + chips) -->
      <div class="teacher-header" id="teacherHeader" style="display:none;">
        <div class="teacher-title" id="teacherTitle"></div>
        <div class="teacher-chips">
          <span class="chip chip-class" title="Horas de clase">
            <i class="fa-solid fa-chalkboard-user"></i>
            <span id="chipClassHours">0H</span>
          </span>
          <span class="chip chip-act" title="Horas de gestiones varias">
            <i class="fa-solid fa-clipboard-list"></i>
            <span id="chipActHours">0H</span>
          </span>
        </div>
      </div>

      <div class="small-note" id="teacherSub" style="display:none;">Intervalos de 30 minutos. Las celdas pueden contener varias filas (clases y/o gestiones).</div>

      <div class="sched-wrap" id="schedWrap" style="display:none; margin-top:10px;">
        <table class="sched" id="schedTable">
          <thead>
            <tr>
              <th style="width:80px;">Hora</th>
              <th>LUNES</th><th>MARTES</th><th>MIERCOLES</th><th>JUEVES</th><th>VIERNES</th><th>SABADO</th>
            </tr>
          </thead>
          <tbody id="schedBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <script type="module" src="./distribucion-docente.js"></script>

  <script>
    requestAnimationFrame(() => {
      document.documentElement.classList.remove('no-theme-transitions');
    });
  </script>
</body>
</html>